<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ç»™å¶å­çš„é“æ­‰</title>
  <style>
    :root{
      --bg1:#070816;
      --bg2:#1a0a2c;
      --card:#ffffff14;
      --card2:#ffffff1c;
      --txt:#fff;
      --muted:#ffffffcc;
      --yes:#4ade80;
      --no:#f87171;
      --btnTxt:#0b1020;
    }
    *{ box-sizing:border-box; }
    html,body{ height:100%; margin:0; font-family: system-ui, -apple-system, "Segoe UI", Roboto, "PingFang SC","Noto Sans SC", Arial, sans-serif; }
    body{
      overflow:hidden;
      background:
        radial-gradient(1200px 700px at 20% 20%, #3b82f650, transparent 60%),
        radial-gradient(900px 600px at 80% 30%, #a855f750, transparent 55%),
        radial-gradient(900px 700px at 50% 90%, #22c55e30, transparent 55%),
        linear-gradient(135deg, var(--bg1), var(--bg2));
      color:var(--txt);
    }

    /* FX layer */
    canvas#fx{
      position:fixed; inset:0;
      pointer-events:none;
      z-index:999;
    }

    .wrap{
      height:100%;
      display:grid;
      place-items:center;
      padding:24px;
    }
    .card{
      width:min(900px, 96vw);
      border-radius:28px;
      background: linear-gradient(180deg, var(--card), var(--card2));
      backdrop-filter: blur(10px);
      border:1px solid #ffffff22;
      box-shadow: 0 20px 90px #00000066;
      padding:34px 28px 24px;
      position:relative;
    }

    h1{
      margin:0 0 10px;
      font-size: clamp(30px, 4.2vw, 46px);
      letter-spacing: .4px;
      line-height: 1.15;
    }
    p{
      margin: 12px 0;
      color: var(--muted);
      line-height:1.7;
      font-size: clamp(16px, 2vw, 20px);
    }
    .note{
      margin-top:16px;
      padding:16px 18px;
      border-radius:18px;
      background:#ffffff12;
      border:1px dashed #ffffff33;
      color:#f1f2ff;
      font-size: clamp(15px, 1.7vw, 18px);
      line-height: 1.7;
    }

    .stage{
      position:relative;
      margin-top:22px;
      height:260px;
      border-radius:22px;
      background: #00000022;
      border:1px solid #ffffff14;
      overflow:hidden;
    }

    .btn{
      border:0;
      padding:16px 28px;
      font-weight:900;
      border-radius:999px;
      cursor:pointer;
      user-select:none;
      box-shadow: 0 12px 34px #00000055;
      transition: transform .12s ease, filter .12s ease, box-shadow .12s ease;
      position:absolute;
      min-width:150px;
      font-size: 20px;
      letter-spacing: .5px;
    }
    .btn:hover{ transform: translateY(-2px) scale(1.02); filter:brightness(1.03); }
    .btn:active{ transform: translateY(0) scale(0.99); box-shadow: 0 8px 22px #00000044; }

    #yesBtn{ background: var(--yes); color: var(--btnTxt); left: 30%; top: 58%; }
    #noBtn{ background: var(--no); color: #ffffff; left: 58%; top: 58%; }

    .toast{
      position:fixed;
      left:50%;
      top:18px;
      transform: translateX(-50%);
      background:#00000066;
      border:1px solid #ffffff22;
      backdrop-filter: blur(8px);
      color:#ffffffef;
      padding:12px 16px;
      border-radius:999px;
      font-size:14px;
      z-index:1001;
      opacity:0;
      transition: opacity .25s ease, transform .25s ease;
      pointer-events:none;
    }
    .toast.show{
      opacity:1;
      transform: translateX(-50%) translateY(4px);
    }

    /* Pink heart background text card */
    .couponWrap{
      position:fixed;
      left:50%;
      top:50%;
      transform: translate(-50%, -50%) scale(0.98);
      z-index:1002;
      opacity:0;
      transition: opacity .6s ease, transform .6s ease;
      pointer-events:none;
      text-align:center;
      padding: 0 16px;
    }
    .couponWrap.show{
      opacity:1;
      transform: translate(-50%, -50%) scale(1);
    }

    .heartCard{
      display:inline-grid;
      place-items:center;
      padding: 26px 30px;
      color:#fff;
      font-weight:1000;
      font-size: clamp(20px, 3vw, 34px);
      line-height: 1.25;
      text-shadow: 0 10px 30px rgba(0,0,0,.45);
      filter: drop-shadow(0 20px 60px rgba(0,0,0,.45));
      position:relative;
    }

    /* Heart shape using pseudo-elements */
    .heartCard::before,
    .heartCard::after{
      content:"";
      position:absolute;
      width: 220px;
      height: 220px;
      background: #ff4fa3; /* solid pink */
      border-radius: 50%;
      top: 0;
    }
    .heartCard::before{ left: 0; }
    .heartCard::after{ right: 0; }

    .heartCard .heartBase{
      position:absolute;
      width: 310px;
      height: 310px;
      background: #ff4fa3; /* solid pink */
      transform: rotate(45deg);
      top: 65px;
      border-radius: 28px;
      box-shadow: 0 18px 50px rgba(255,79,163,.65);
    }

    .heartCard span{
      position:relative;
      z-index:1;
      display:block;
      max-width: 620px;
    }

    /* Audio element hidden */
    audio{ display:none; }
  </style>
</head>
<body>
  <canvas id="fx"></canvas>
  <div class="toast" id="toast">å®ƒè·‘äº†â€¦å› ä¸ºå®ƒå¿ƒè™š ğŸ˜…</div>

  <!-- You will upload a file named bgm.mp3 -->
  <audio id="bgm" src="./bgm.mp3" preload="auto" loop></audio>

  <div class="couponWrap" id="couponWrap">
    <div class="heartCard">
      <div class="heartBase"></div>
      <span>è¿™æ˜¯ä¸€å¼ æ— æ¡ä»¶å¦¥ååˆ¸ï¼Œèµ¶å¿«æˆªå›¾ï¼Œæ—¥åä½¿ç”¨ã€‚</span>
    </div>
  </div>

  <div class="wrap">
    <div class="card">
      <h1>å¶å­ï¼Œæˆ‘æƒ³è®¤çœŸè·Ÿä½ è¯´å£°å¯¹ä¸èµ·ã€‚</h1>
      <p>
        æˆ‘çŸ¥é“ä½ ç°åœ¨å¾ˆå¤±æœ›ï¼Œä¹Ÿéœ€è¦æ—¶é—´æ¶ˆåŒ–ã€‚<br>
        æˆ‘ä¼šç”¨è¡ŒåŠ¨æŠŠä½ è¦çš„â€œå¯é â€å’Œâ€œå¦è¯šâ€æ‹¼å¥½ã€‚
      </p>

      <div class="note">
        ä½ å¯ä»¥æ…¢æ…¢æ¶ˆåŒ–ã€‚æˆ‘ä¼šåœ¨ï¼Œä¸é€ƒé¿ï¼Œä¹Ÿä¸æ•·è¡ã€‚<br>
        åªè¦ä½ æ„¿æ„ç»™æˆ‘ä¸€æ¬¡æœºä¼šï¼Œæˆ‘ä¼šæŠŠâ€œä½ æœ€é‡è¦â€åšæˆé•¿æœŸæœ‰æ•ˆã€‚
      </div>

      <div class="stage" id="stage">
        <button class="btn" id="yesBtn">åŸè°…</button>
        <button class="btn" id="noBtn">ä¸åŸè°…</button>
      </div>
    </div>
  </div>

<script>
  // ========= 1) â€œä¸åŸè°…â€æŒ‰é’®èº²é¿ =========
  const stage = document.getElementById('stage');
  const noBtn = document.getElementById('noBtn');
  const yesBtn = document.getElementById('yesBtn');
  const toast = document.getElementById('toast');
  const couponWrap = document.getElementById('couponWrap');
  const bgm = document.getElementById('bgm');

  let lastMoveAt = 0;
  function showToast(){
    toast.classList.add('show');
    clearTimeout(showToast._t);
    showToast._t = setTimeout(()=> toast.classList.remove('show'), 850);
  }
  function clamp(n,min,max){ return Math.max(min, Math.min(max,n)); }

  function moveNoButton(){
    const now = performance.now();
    if (now - lastMoveAt < 120) return;
    lastMoveAt = now;

    const pad = 18;
    const st = stage.getBoundingClientRect();
    const nb = noBtn.getBoundingClientRect();
    const maxLeft = st.width - nb.width - pad;
    const maxTop  = st.height - nb.height - pad;

    const left = clamp(Math.random()*maxLeft, pad, maxLeft);
    const top  = clamp(Math.random()*maxTop,  pad, maxTop);

    noBtn.style.left = left + 'px';
    noBtn.style.top  = top + 'px';

    noBtn.animate([
      { transform: 'translateY(0) rotate(0deg) scale(1)' },
      { transform: 'translateY(-3px) rotate(-4deg) scale(1.03)' },
      { transform: 'translateY(0) rotate(3deg) scale(1)' }
    ], { duration: 220, easing: 'ease-out' });

    showToast();
  }

  ['mouseenter','mousemove','pointermove','touchstart'].forEach(evt=>{
    noBtn.addEventListener(evt, (e)=>{
      moveNoButton();
      e.preventDefault?.();
    }, { passive:false });
  });

  stage.addEventListener('mousemove', (e)=>{
    const st = stage.getBoundingClientRect();
    const x = e.clientX - st.left;
    const y = e.clientY - st.top;

    const nb = noBtn.getBoundingClientRect();
    const nx = (nb.left - st.left) + nb.width/2;
    const ny = (nb.top - st.top) + nb.height/2;

    const dist = Math.hypot(x-nx, y-ny);
    if (dist < 95) moveNoButton();
  });

  // ========= 2) Continuous heart burst from center =========
  const canvas = document.getElementById('fx');
  const ctx = canvas.getContext('2d');

  function resize(){
    const dpr = window.devicePixelRatio || 1;
    canvas.width = Math.floor(window.innerWidth * dpr);
    canvas.height = Math.floor(window.innerHeight * dpr);
    canvas.style.width = window.innerWidth + 'px';
    canvas.style.height = window.innerHeight + 'px';
    ctx.setTransform(dpr,0,0,dpr,0,0);
  }
  window.addEventListener('resize', resize);
  resize();

  let hearts = [];
  let running = false;
  let lastSpawn = 0;

  function rand(min,max){ return min + Math.random()*(max-min); }

  function spawnHeartsFromCenter(count){
    const cx = window.innerWidth/2;
    const cy = window.innerHeight/2;

    for(let i=0;i<count;i++){
      const a = Math.random()*Math.PI*2;
      const speed = rand(1.8, 5.2);
      hearts.push({
        x: cx + rand(-6,6),
        y: cy + rand(-6,6),
        vx: Math.cos(a)*speed,
        vy: Math.sin(a)*speed,
        rot: rand(0, Math.PI*2),
        vr: rand(-0.06, 0.06),
        life: 0,
        ttl: rand(1400, 2400),
        size: rand(14, 28),
        emoji: Math.random() < 0.6 ? 'ğŸ’—' : (Math.random() < 0.5 ? 'ğŸ’–' : 'ğŸ’')
      });
    }
  }

  function tick(now){
    if (!running) return;

    const w = window.innerWidth, h = window.innerHeight;
    ctx.clearRect(0,0,w,h);

    // spawn continuously (about 35-55 hearts/sec)
    if (now - lastSpawn > 70){
      lastSpawn = now;
      spawnHeartsFromCenter(4);
    }

    // update & draw
    hearts = hearts.filter(p => p.life < p.ttl);

    for(const p of hearts){
      p.life += 16;
      const k = p.life / p.ttl;

      // motion
      p.x += p.vx;
      p.y += p.vy;
      p.vy += 0.004 * p.life; // tiny gravity feels like â€œfalling sparklesâ€
      p.rot += p.vr;

      // fade out near end
      const alpha = k < 0.75 ? 1 : Math.max(0, 1 - (k-0.75)/0.25);

      ctx.save();
      ctx.globalAlpha = alpha;
      ctx.translate(p.x, p.y);
      ctx.rotate(p.rot);
      ctx.font = `${p.size}px system-ui, "Apple Color Emoji","Segoe UI Emoji"`;
      ctx.textAlign = 'center';
      ctx.textBaseline = 'middle';
      ctx.fillText(p.emoji, 0, 0);
      ctx.restore();
    }

    requestAnimationFrame(tick);
  }

  // ========= 3) Click yes: start everything =========
  let started = false;

  yesBtn.addEventListener('click', async ()=>{
    if (started) return;
    started = true;

    // lock buttons
    yesBtn.disabled = true;
    noBtn.disabled = true;
    noBtn.style.opacity = '0.35';

    // show pink heart coupon text
    couponWrap.classList.add('show');

    // play uploaded mp3 (requires user gesture, this click qualifies)
    try{
      await bgm.play();
    }catch(e){
      // if it fails, it's usually because the file is missing or autoplay restrictions
      // user gesture already happened, so missing file is most common
      console.log('BGM play failed:', e);
    }

    // start continuous hearts
    running = true;
    lastSpawn = performance.now();
    requestAnimationFrame(tick);
  });
</script>
</body>
</html>
